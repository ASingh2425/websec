
import React from 'react';
import { ProbableVulnerability } from '../types';
import { AlertOctagon, AlertTriangle, Eye, ArrowRight, Activity, Microscope } from 'lucide-react';

interface Props {
  vulnerabilities: ProbableVulnerability[];
}

export const ProbableVulnerabilityList: React.FC<Props> = ({ vulnerabilities }) => {
  if (vulnerabilities.length === 0) {
    return (
        <div className="cyber-card p-12 text-center flex flex-col items-center bg-cyber-card border-dashed border-cyber-border">
            <div className="w-16 h-16 bg-cyber-cardHighlight rounded-full flex items-center justify-center mb-4 border border-cyber-border">
                <Microscope size={32} className="text-cyber-text-muted" />
            </div>
            <h4 className="text-lg font-bold text-cyber-text-main font-display">No Heuristic Indicators</h4>
            <p className="text-cyber-text-muted text-sm mt-2 max-w-sm">
                Deep analysis did not find patterns suggesting hidden flaws like Blind SQLi or IDOR.
            </p>
        </div>
    );
  }

  return (
    <div className="space-y-6">
      <div className="bg-amber-500/10 border border-amber-500/20 p-4 rounded-xl flex gap-3 items-start">
         <AlertTriangle className="text-amber-400 shrink-0 mt-0.5" size={18} />
         <div>
            <h4 className="text-amber-400 font-bold text-sm uppercase tracking-wider mb-1">Heuristic Analysis (Unconfirmed)</h4>
            <p className="text-cyber-text-secondary text-xs leading-relaxed">
                These findings are <strong>not confirmed</strong> but are highly probable based on architectural patterns, input vectors, and technology stack. 
                They represent the "Deep Gaps" (Blind SQLi, IDOR, Logic Flaws) that automated scanners often miss without active exploitation.
            </p>
         </div>
      </div>

      <div className="grid grid-cols-1 gap-4">
        {vulnerabilities.map((vuln, idx) => (
            <div key={idx} className="cyber-card group p-0 overflow-hidden border-cyber-border hover:border-amber-500/30 transition-colors">
                <div className="p-5 flex flex-col md:flex-row gap-6">
                    
                    {/* Left: Indicator */}
                    <div className="flex flex-col items-center justify-center w-full md:w-32 shrink-0 border-b md:border-b-0 md:border-r border-cyber-border/50 pb-4 md:pb-0">
                         <div className={`w-12 h-12 rounded-2xl flex items-center justify-center mb-2 ${
                             vuln.likelihood === 'High' ? 'bg-rose-500/10 text-rose-400' : 'bg-amber-500/10 text-amber-400'
                         }`}>
                            <AlertOctagon size={24} />
                         </div>
                         <div className={`text-xs font-bold uppercase tracking-widest ${
                             vuln.likelihood === 'High' ? 'text-rose-400' : 'text-amber-400'
                         }`}>
                             {vuln.likelihood} Probability
                         </div>
                    </div>

                    {/* Middle: Details */}
                    <div className="flex-1 space-y-4">
                        <div>
                            <div className="flex items-center gap-2 mb-1">
                                <span className="text-[10px] font-mono bg-cyber-bg border border-cyber-border px-2 py-0.5 rounded text-cyber-text-muted">
                                    {vuln.category}
                                </span>
                            </div>
                            <h3 className="text-lg font-bold text-cyber-text-main group-hover:text-amber-400 transition-colors font-display">
                                {vuln.title}
                            </h3>
                            <div className="text-xs font-mono text-cyber-text-secondary mt-1">
                                Location: <span className="text-cyber-primary">{vuln.location}</span>
                            </div>
                        </div>
                        
                        <div className="bg-cyber-cardHighlight/50 p-3 rounded-lg border border-cyber-border">
                            <h5 className="text-[10px] font-bold text-cyber-text-muted uppercase tracking-widest mb-1 flex items-center gap-1">
                                <Activity size={12} /> Analysis Reasoning
                            </h5>
                            <p className="text-sm text-cyber-text-secondary leading-relaxed">
                                {vuln.reasoning}
                            </p>
                        </div>
                    </div>

                    {/* Right: Verification */}
                    <div className="w-full md:w-64 shrink-0 bg-cyber-bg p-4 rounded-xl border border-cyber-border">
                        <h5 className="text-[10px] font-bold text-cyber-text-muted uppercase tracking-widest mb-2 flex items-center gap-1">
                             <Eye size={12} /> Manual Verification
                        </h5>
                        <p className="text-xs text-cyber-text-secondary leading-relaxed mb-3">
                            {vuln.verificationSteps}
                        </p>
                        <button className="w-full py-2 bg-cyber-card border border-cyber-border hover:bg-cyber-cardHighlight text-cyber-text-main text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-2">
                            Add to Pentest Queue <ArrowRight size={12} />
                        </button>
                    </div>
                </div>
            </div>
        ))}
      </div>
    </div>
  );
};
